<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_131) on Thu Oct 26 20:11:46 UTC 2017 -->
<title>SessionKeys</title>
<meta name="date" content="2017-10-26">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="SessionKeys";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":9,"i1":9,"i2":9,"i3":9,"i4":9,"i5":9,"i6":9,"i7":9,"i8":9,"i9":9,"i10":9,"i11":9,"i12":9,"i13":9,"i14":9};
var tabs = {65535:["t0","All Methods"],1:["t1","Static Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../edu/umass/cs/utils/RepeatRule.html" title="class in edu.umass.cs.utils"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../edu/umass/cs/utils/SessionKeys.Events.html" title="enum in edu.umass.cs.utils"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?edu/umass/cs/utils/SessionKeys.html" target="_top">Frames</a></li>
<li><a href="SessionKeys.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">edu.umass.cs.utils</div>
<h2 title="Class SessionKeys" class="title">Class SessionKeys</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>edu.umass.cs.utils.SessionKeys</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public class <span class="typeNameLabel">SessionKeys</span>
extends java.lang.Object</pre>
<dl>
<dt><span class="simpleTagLabel">Author:</span></dt>
<dd>arun

         A utility class to generate and maintain symmetric session keys. It
         allows a client or a server to maintain one or more session secret
         keys corresponding to a public key so as to use symmetric key
         encryption instead of public key encryption.
 
         <p>
 
         An important assumption is that rhe two endpoints already have an SSL
         connection, so a man-in-the-middle can not decipher any data
         exchanged. If this is not true, this utility class is not useful.
 
         <p>
 
         A secret key can only be proposed by the possessor of the private key
         corresponding to the public key that is being substituted.
 
         <p>
 
         Multiple secret keys corresponding to the same public key can get
         generated over time, e.g., different (multi-homed) clients all using
         the same public key may simultaneously maintain sessions with the
         same server. We will refer to the owner of the public/private key
         pair the "client". Generally, a client will propose a secret key by
         issuing a self-signed certificate. A server may also at any time
         respond with a certificate for the same key-pair that it may have
         obtained from elsewhere, e.g., from another avatar of the client. If
         a server or client receives a message signed by a secret key it
         doesn't have, it can ask the other end for the corresponding
         certificate.
 
         All methods and state here is static as the symmetric keys correspond
         only to public keys, so they can be reused even within "virtual"
         nodes within a JVM.</dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="nested.class.summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Nested Class Summary table, listing nested classes, and an explanation">
<caption><span>Nested Classes</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Class and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static class&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../edu/umass/cs/utils/SessionKeys.Events.html" title="enum in edu.umass.cs.utils">SessionKeys.Events</a></span></code>
<div class="block">Events associated with secret session keys.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected static class&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../edu/umass/cs/utils/SessionKeys.SecretKeyAndCertificate.html" title="class in edu.umass.cs.utils">SessionKeys.SecretKeyAndCertificate</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static class&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../edu/umass/cs/utils/SessionKeys.SecretKeyCertificate.html" title="class in edu.umass.cs.utils">SessionKeys.SecretKeyCertificate</a></span></code>
<div class="block">A secret key certificate consists of a [secretKey, timestamp] 2-tuple
 signed by the corresponding public key, and all three of these together
 form the certificate.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected static java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../edu/umass/cs/utils/SessionKeys.html#keyPairAlgorithm">keyPairAlgorithm</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected static java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../edu/umass/cs/utils/SessionKeys.html#pkPair">pkPair</a></span></code>
<div class="block">Implementations on some devices require us to completely specify the
 transformation in the form of "ALGORITHM/MODE/PADDING" since the mode
 and padding defaults are not necessarily same across providers.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../edu/umass/cs/utils/SessionKeys.html#SessionKeys--">SessionKeys</a></span>()</code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t1" class="tableTab"><span><a href="javascript:show(1);">Static Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>static long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../edu/umass/cs/utils/SessionKeys.html#getEncryptedSecretKeyTimestamp-byte:A-">getEncryptedSecretKeyTimestamp</a></span>(byte[]&nbsp;encoded)</code>&nbsp;</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>static javax.crypto.SecretKey</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../edu/umass/cs/utils/SessionKeys.html#getOrGenerateSecretKey-java.security.PublicKey-java.security.PrivateKey-">getOrGenerateSecretKey</a></span>(java.security.PublicKey&nbsp;publicKey,
                      java.security.PrivateKey&nbsp;privateKey)</code>&nbsp;</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>static javax.crypto.SecretKey</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../edu/umass/cs/utils/SessionKeys.html#getSecretKey-java.security.PublicKey-">getSecretKey</a></span>(java.security.PublicKey&nbsp;publicKey)</code>&nbsp;</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>static javax.crypto.SecretKey</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../edu/umass/cs/utils/SessionKeys.html#getSecretKey-java.security.PublicKey-java.lang.Long-">getSecretKey</a></span>(java.security.PublicKey&nbsp;publicKey,
            java.lang.Long&nbsp;secretKeyID)</code>&nbsp;</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>static <a href="../../../../edu/umass/cs/utils/SessionKeys.SecretKeyCertificate.html" title="class in edu.umass.cs.utils">SessionKeys.SecretKeyCertificate</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../edu/umass/cs/utils/SessionKeys.html#getSecretKeyCertificate-java.security.PublicKey-">getSecretKeyCertificate</a></span>(java.security.PublicKey&nbsp;publicKey)</code>&nbsp;</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>static javax.crypto.SecretKey</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../edu/umass/cs/utils/SessionKeys.html#getSecretKeyFromCertificate-byte:A-">getSecretKeyFromCertificate</a></span>(byte[]&nbsp;encodedSecretKeyCertificate)</code>&nbsp;</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>static javax.crypto.SecretKey</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../edu/umass/cs/utils/SessionKeys.html#getSecretKeyFromCertificate-byte:A-java.security.PublicKey-">getSecretKeyFromCertificate</a></span>(byte[]&nbsp;encodedSecretKeyCertificate,
                           java.security.PublicKey&nbsp;publicKey)</code>&nbsp;</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code>static void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../edu/umass/cs/utils/SessionKeys.html#main-java.lang.String:A-">main</a></span>(java.lang.String[]&nbsp;args)</code>&nbsp;</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code>static void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../edu/umass/cs/utils/SessionKeys.html#putSecretKey-javax.crypto.SecretKey-edu.umass.cs.utils.SessionKeys.SecretKeyCertificate-">putSecretKey</a></span>(javax.crypto.SecretKey&nbsp;secretKey,
            <a href="../../../../edu/umass/cs/utils/SessionKeys.SecretKeyCertificate.html" title="class in edu.umass.cs.utils">SessionKeys.SecretKeyCertificate</a>&nbsp;skCert)</code>&nbsp;</td>
</tr>
<tr id="i9" class="rowColor">
<td class="colFirst"><code>static void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../edu/umass/cs/utils/SessionKeys.html#setClient--">setClient</a></span>()</code>
<div class="block">Sets maximum number of secret keys per public key to 1.</div>
</td>
</tr>
<tr id="i10" class="altColor">
<td class="colFirst"><code>static void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../edu/umass/cs/utils/SessionKeys.html#setMaxPublicKeys-int-">setMaxPublicKeys</a></span>(int&nbsp;n)</code>&nbsp;</td>
</tr>
<tr id="i11" class="rowColor">
<td class="colFirst"><code>static void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../edu/umass/cs/utils/SessionKeys.html#setMaxSecretKeys-int-">setMaxSecretKeys</a></span>(int&nbsp;n)</code>
<div class="block">Maximum number of secret keys per public key.</div>
</td>
</tr>
<tr id="i12" class="altColor">
<td class="colFirst"><code>static void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../edu/umass/cs/utils/SessionKeys.html#setSecretKeyLifetime-long-">setSecretKeyLifetime</a></span>(long&nbsp;lifetime)</code>&nbsp;</td>
</tr>
<tr id="i13" class="rowColor">
<td class="colFirst"><code>static boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../edu/umass/cs/utils/SessionKeys.html#shouldSendSecretKey-edu.umass.cs.utils.SessionKeys.SecretKeyAndCertificate-">shouldSendSecretKey</a></span>(<a href="../../../../edu/umass/cs/utils/SessionKeys.SecretKeyAndCertificate.html" title="class in edu.umass.cs.utils">SessionKeys.SecretKeyAndCertificate</a>&nbsp;skc)</code>&nbsp;</td>
</tr>
<tr id="i14" class="altColor">
<td class="colFirst"><code>static javax.crypto.SecretKey</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../edu/umass/cs/utils/SessionKeys.html#verify-edu.umass.cs.utils.SessionKeys.SecretKeyCertificate-">verify</a></span>(<a href="../../../../edu/umass/cs/utils/SessionKeys.SecretKeyCertificate.html" title="class in edu.umass.cs.utils">SessionKeys.SecretKeyCertificate</a>&nbsp;skCert)</code>&nbsp;</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="pkPair">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>pkPair</h4>
<pre>protected static final&nbsp;java.lang.String pkPair</pre>
<div class="block">Implementations on some devices require us to completely specify the
 transformation in the form of "ALGORITHM/MODE/PADDING" since the mode
 and padding defaults are not necessarily same across providers.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../constant-values.html#edu.umass.cs.utils.SessionKeys.pkPair">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="keyPairAlgorithm">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>keyPairAlgorithm</h4>
<pre>protected static final&nbsp;java.lang.String keyPairAlgorithm</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../constant-values.html#edu.umass.cs.utils.SessionKeys.keyPairAlgorithm">Constant Field Values</a></dd>
</dl>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="SessionKeys--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>SessionKeys</h4>
<pre>public&nbsp;SessionKeys()</pre>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="getSecretKeyFromCertificate-byte:A-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getSecretKeyFromCertificate</h4>
<pre>public static&nbsp;javax.crypto.SecretKey&nbsp;getSecretKeyFromCertificate(byte[]&nbsp;encodedSecretKeyCertificate)
                                                          throws java.security.spec.InvalidKeySpecException,
                                                                 java.security.NoSuchAlgorithmException,
                                                                 java.security.InvalidKeyException,
                                                                 javax.crypto.NoSuchPaddingException,
                                                                 javax.crypto.IllegalBlockSizeException,
                                                                 javax.crypto.BadPaddingException</pre>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>encodedSecretKeyCertificate</code> - </dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>Secret key decoded from <code>encodedSecretKeyCertificate</code>.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.security.spec.InvalidKeySpecException</code></dd>
<dd><code>java.security.NoSuchAlgorithmException</code></dd>
<dd><code>javax.crypto.BadPaddingException</code></dd>
<dd><code>javax.crypto.IllegalBlockSizeException</code></dd>
<dd><code>javax.crypto.NoSuchPaddingException</code></dd>
<dd><code>java.security.InvalidKeyException</code></dd>
</dl>
</li>
</ul>
<a name="getSecretKeyFromCertificate-byte:A-java.security.PublicKey-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getSecretKeyFromCertificate</h4>
<pre>public static&nbsp;javax.crypto.SecretKey&nbsp;getSecretKeyFromCertificate(byte[]&nbsp;encodedSecretKeyCertificate,
                                                                 java.security.PublicKey&nbsp;publicKey)
                                                          throws java.security.spec.InvalidKeySpecException,
                                                                 java.security.NoSuchAlgorithmException,
                                                                 javax.crypto.NoSuchPaddingException,
                                                                 java.security.InvalidKeyException,
                                                                 javax.crypto.IllegalBlockSizeException,
                                                                 javax.crypto.BadPaddingException</pre>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>encodedSecretKeyCertificate</code> - </dd>
<dd><code>publicKey</code> - </dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>Secret key decoded from <code>encodedSecretKeyCertificate</code>.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.security.spec.InvalidKeySpecException</code></dd>
<dd><code>java.security.NoSuchAlgorithmException</code></dd>
<dd><code>javax.crypto.NoSuchPaddingException</code></dd>
<dd><code>java.security.InvalidKeyException</code></dd>
<dd><code>javax.crypto.BadPaddingException</code></dd>
<dd><code>javax.crypto.IllegalBlockSizeException</code></dd>
</dl>
</li>
</ul>
<a name="getEncryptedSecretKeyTimestamp-byte:A-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getEncryptedSecretKeyTimestamp</h4>
<pre>public static&nbsp;long&nbsp;getEncryptedSecretKeyTimestamp(byte[]&nbsp;encoded)</pre>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>encoded</code> - </dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>Encrypted secret key timestamp.</dd>
</dl>
</li>
</ul>
<a name="setMaxPublicKeys-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setMaxPublicKeys</h4>
<pre>public static&nbsp;void&nbsp;setMaxPublicKeys(int&nbsp;n)</pre>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>n</code> - </dd>
</dl>
</li>
</ul>
<a name="setMaxSecretKeys-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setMaxSecretKeys</h4>
<pre>public static&nbsp;void&nbsp;setMaxSecretKeys(int&nbsp;n)</pre>
<div class="block">Maximum number of secret keys per public key. Clients should set this to
 1 as they should have at most secret key per public key at any time.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>n</code> - </dd>
</dl>
</li>
</ul>
<a name="setClient--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setClient</h4>
<pre>public static&nbsp;void&nbsp;setClient()</pre>
<div class="block">Sets maximum number of secret keys per public key to 1.</div>
</li>
</ul>
<a name="setSecretKeyLifetime-long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setSecretKeyLifetime</h4>
<pre>public static&nbsp;void&nbsp;setSecretKeyLifetime(long&nbsp;lifetime)</pre>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>lifetime</code> - </dd>
</dl>
</li>
</ul>
<a name="getSecretKey-java.security.PublicKey-java.lang.Long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getSecretKey</h4>
<pre>public static&nbsp;javax.crypto.SecretKey&nbsp;getSecretKey(java.security.PublicKey&nbsp;publicKey,
                                                  java.lang.Long&nbsp;secretKeyID)</pre>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>publicKey</code> - </dd>
<dd><code>secretKeyID</code> - </dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>Stored secret key if any, else null.</dd>
</dl>
</li>
</ul>
<a name="getSecretKey-java.security.PublicKey-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getSecretKey</h4>
<pre>public static&nbsp;javax.crypto.SecretKey&nbsp;getSecretKey(java.security.PublicKey&nbsp;publicKey)</pre>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>publicKey</code> - </dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>SecretKey corresponding to publicKey.</dd>
</dl>
</li>
</ul>
<a name="getOrGenerateSecretKey-java.security.PublicKey-java.security.PrivateKey-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getOrGenerateSecretKey</h4>
<pre>public static&nbsp;javax.crypto.SecretKey&nbsp;getOrGenerateSecretKey(java.security.PublicKey&nbsp;publicKey,
                                                            java.security.PrivateKey&nbsp;privateKey)
                                                     throws java.security.InvalidKeyException,
                                                            java.security.NoSuchAlgorithmException,
                                                            java.security.SignatureException,
                                                            java.io.UnsupportedEncodingException,
                                                            javax.crypto.IllegalBlockSizeException,
                                                            javax.crypto.BadPaddingException,
                                                            javax.crypto.NoSuchPaddingException</pre>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>publicKey</code> - </dd>
<dd><code>privateKey</code> - </dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>Secret key, possibly generated on demand.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.security.InvalidKeyException</code></dd>
<dd><code>java.security.NoSuchAlgorithmException</code></dd>
<dd><code>java.security.SignatureException</code></dd>
<dd><code>java.io.UnsupportedEncodingException</code></dd>
<dd><code>javax.crypto.NoSuchPaddingException</code></dd>
<dd><code>javax.crypto.BadPaddingException</code></dd>
<dd><code>javax.crypto.IllegalBlockSizeException</code></dd>
</dl>
</li>
</ul>
<a name="putSecretKey-javax.crypto.SecretKey-edu.umass.cs.utils.SessionKeys.SecretKeyCertificate-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>putSecretKey</h4>
<pre>public static&nbsp;void&nbsp;putSecretKey(javax.crypto.SecretKey&nbsp;secretKey,
                                <a href="../../../../edu/umass/cs/utils/SessionKeys.SecretKeyCertificate.html" title="class in edu.umass.cs.utils">SessionKeys.SecretKeyCertificate</a>&nbsp;skCert)</pre>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>secretKey</code> - </dd>
<dd><code>skCert</code> - </dd>
</dl>
</li>
</ul>
<a name="shouldSendSecretKey-edu.umass.cs.utils.SessionKeys.SecretKeyAndCertificate-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>shouldSendSecretKey</h4>
<pre>public static&nbsp;boolean&nbsp;shouldSendSecretKey(<a href="../../../../edu/umass/cs/utils/SessionKeys.SecretKeyAndCertificate.html" title="class in edu.umass.cs.utils">SessionKeys.SecretKeyAndCertificate</a>&nbsp;skc)</pre>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>skc</code> - </dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>True if the secret key certificate should be sent to the remote
         endpoint along with the secret-key-signed message.</dd>
</dl>
</li>
</ul>
<a name="verify-edu.umass.cs.utils.SessionKeys.SecretKeyCertificate-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>verify</h4>
<pre>public static&nbsp;javax.crypto.SecretKey&nbsp;verify(<a href="../../../../edu/umass/cs/utils/SessionKeys.SecretKeyCertificate.html" title="class in edu.umass.cs.utils">SessionKeys.SecretKeyCertificate</a>&nbsp;skCert)
                                     throws java.security.SignatureException,
                                            java.security.NoSuchAlgorithmException,
                                            javax.crypto.IllegalBlockSizeException,
                                            javax.crypto.BadPaddingException,
                                            javax.crypto.NoSuchPaddingException,
                                            java.security.InvalidKeyException</pre>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>skCert</code> - </dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>Decrypts and returns the secret key contained in the supplied
         secret key certificate.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.security.SignatureException</code></dd>
<dd><code>java.security.NoSuchAlgorithmException</code></dd>
<dd><code>javax.crypto.IllegalBlockSizeException</code></dd>
<dd><code>javax.crypto.BadPaddingException</code></dd>
<dd><code>javax.crypto.NoSuchPaddingException</code></dd>
<dd><code>java.security.InvalidKeyException</code></dd>
</dl>
</li>
</ul>
<a name="getSecretKeyCertificate-java.security.PublicKey-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getSecretKeyCertificate</h4>
<pre>public static&nbsp;<a href="../../../../edu/umass/cs/utils/SessionKeys.SecretKeyCertificate.html" title="class in edu.umass.cs.utils">SessionKeys.SecretKeyCertificate</a>&nbsp;getSecretKeyCertificate(java.security.PublicKey&nbsp;publicKey)</pre>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>publicKey</code> - </dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>SecretKeyCertificate corresponding to publicKey. This method will
         return the most recent if multiple certificates exist.</dd>
</dl>
</li>
</ul>
<a name="main-java.lang.String:A-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>main</h4>
<pre>public static&nbsp;void&nbsp;main(java.lang.String[]&nbsp;args)</pre>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>args</code> - </dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../edu/umass/cs/utils/RepeatRule.html" title="class in edu.umass.cs.utils"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../edu/umass/cs/utils/SessionKeys.Events.html" title="enum in edu.umass.cs.utils"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?edu/umass/cs/utils/SessionKeys.html" target="_top">Frames</a></li>
<li><a href="SessionKeys.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
